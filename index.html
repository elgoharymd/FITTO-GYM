<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FITTO GYM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --success-color: #4cc9f0;
            --danger-color: #f72585;
            --warning-color: #f8961e;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --border-radius: 0.5rem;
            --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
            --glow-effect: 0 0 15px rgba(67, 97, 238, 0.5);
            --glow-success: 0 0 15px rgba(76, 201, 240, 0.5);
            --glow-danger: 0 0 15px rgba(247, 37, 133, 0.5);
            --glow-warning: 0 0 15px rgba(248, 150, 30, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            box-shadow: var(--box-shadow);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(135deg, 
                rgba(67, 97, 238, 0.8), 
                rgba(63, 55, 201, 0.8));
            z-index: -1;
            filter: blur(15px);
            border-radius: var(--border-radius);
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .logo {
            width: 120px; /* تم تكبير حجم اللوجو */
            height: 120px; /* تم تكبير حجم اللوجو */
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin-bottom: 10px;
            position: relative;
        }

        .logo::after {
            content: "";
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.8);
            animation: pulse 2s infinite;
            pointer-events: none;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
        }

        .club-name {
            font-size: 2rem;
            font-weight: 700;
            margin-top: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary-color);
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
        }

        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .btn::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(45deg);
            transition: var(--transition);
            opacity: 0;
        }

        .btn:hover::after {
            opacity: 1;
            top: -20%;
            left: -20%;
        }

        .btn i {
            margin-left: 0.5rem;
        }

        .btn-sm {
            padding: 0.5rem;
            font-size: 0.875rem;
            width: 35px;
            height: 35px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn-sm i {
            margin: 0;
        }

        .btn-danger {
            background-color: var(--danger-color);
            box-shadow: 0 4px 10px rgba(247, 37, 133, 0.3);
        }

        .btn-danger:hover {
            background-color: #e5177e;
            box-shadow: 0 8px 15px rgba(247, 37, 133, 0.4);
        }

        .btn-warning {
            background-color: var(--warning-color);
            box-shadow: 0 4px 10px rgba(248, 150, 30, 0.3);
        }

        .btn-warning:hover {
            background-color: #e6871b;
            box-shadow: 0 8px 15px rgba(248, 150, 30, 0.4);
        }

        .btn-success {
            background-color: var(--success-color);
            box-shadow: 0 4px 10px rgba(76, 201, 240, 0.3);
        }

        .btn-success:hover {
            background-color: #3ab8d9;
            box-shadow: 0 8px 15px rgba(76, 201, 240, 0.4);
        }

        /* Form Section */
        .form-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            opacity: 0;
            position: relative;
            height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .form-section.active {
            height: auto;
            opacity: 1;
            margin-bottom: 2rem;
            overflow: visible;
        }

        .form-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, 
                var(--success-color), 
                var(--primary-color));
            box-shadow: 0 2px 5px rgba(76, 201, 240, 0.5);
        }

        .form-section h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #eee;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
        }

        .form-group {
            margin-bottom: 1rem;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            font-family: 'Tajawal', sans-serif;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.3), inset 0 1px 3px rgba(0, 0, 0, 0.1);
            outline: none;
        }

        /* Search Box */
        .search-container {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 0.75rem 1.5rem 0.75rem 3rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            box-shadow: var(--box-shadow);
        }

        .search-box:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.3);
            outline: none;
        }

        .search-icon {
            position: absolute;
            top: 50%;
            right: 1rem;
            transform: translateY(-50%);
            color: #6c757d;
        }

        /* Table Section */
        .table-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--box-shadow);
            overflow-x: auto;
            margin-bottom: 2rem;
            position: relative;
        }

        .table-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, 
                var(--primary-color), 
                var(--secondary-color));
            box-shadow: 0 2px 5px rgba(67, 97, 238, 0.5);
        }

        .table-section h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-height: 600px;
            overflow-y: auto;
        }

        .members-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .members-table th,
        .members-table td {
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .members-table th {
            background-color: #f8f9fa;
            font-weight: 700;
            color: var(--dark-color);
            position: sticky;
            top: 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .members-table tr {
            transition: var(--transition);
            position: relative;
        }

        .members-table tr:hover {
            background-color: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 1;
        }

        /* حلقة دائرية حول المشترك */
        .member-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: calc(100% + 20px);
            height: calc(100% + 20px);
            border-radius: 50%;
            border: 2px solid var(--primary-color);
            opacity: 0;
            transition: var(--transition);
            pointer-events: none;
            z-index: -1;
        }

        .members-table tr:hover .member-circle {
            opacity: 0.3;
        }

        /* فاصل مضيء بين المشتركين */
        .member-separator {
            position: relative;
        }

        .member-separator::after {
            content: "";
            position: absolute;
            bottom: -1px;
            left: 10%;
            right: 10%;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(67, 97, 238, 0.5), 
                transparent);
            box-shadow: 0 0 10px rgba(67, 97, 238, 0.3);
        }

        /* Member Glow Effect */
        .members-table tr::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 5px;
            pointer-events: none;
            opacity: 0;
            transition: var(--transition);
        }

        .members-table tr.active-member:hover::after {
            opacity: 1;
            box-shadow: var(--glow-success);
        }

        .members-table tr.expired-member:hover::after {
            opacity: 1;
            box-shadow: var(--glow-danger);
        }

        /* Status Styles */
        .status {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .status-active {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success-color);
            text-shadow: 0 1px 1px rgba(76, 201, 240, 0.3);
        }

        .status-expired {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--danger-color);
            text-shadow: 0 1px 1px rgba(247, 37, 133, 0.3);
        }

        .status-paid {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success-color);
            text-shadow: 0 1px 1px rgba(76, 201, 240, 0.3);
        }

        .status-unpaid {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--danger-color);
            text-shadow: 0 1px 1px rgba(247, 37, 133, 0.3);
        }

        .status-icon {
            margin-left: 0.5rem;
            font-size: 0.875rem;
        }

        /* Amount Styles */
        .amount {
            font-weight: 600;
        }

        .amount-remaining {
            color: var(--success-color);
            text-shadow: 0 1px 1px rgba(76, 201, 240, 0.3);
        }

        .amount-due {
            color: var(--danger-color);
            text-shadow: 0 1px 1px rgba(247, 37, 133, 0.3);
        }

        /* Stats Cards */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-card.active-members:hover {
            box-shadow: var(--glow-success);
        }

        .stat-card.expired-members:hover {
            box-shadow: var(--glow-danger);
        }

        .stat-card.active-members::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--success-color);
            box-shadow: 0 2px 5px rgba(76, 201, 240, 0.5);
        }

        .stat-card.expired-members::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--danger-color);
            box-shadow: 0 2px 5px rgba(247, 37, 133, 0.5);
        }

        .stat-title {
            font-size: 1rem;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-card.active-members .stat-value {
            color: var(--success-color);
            text-shadow: 0 2px 3px rgba(76, 201, 240, 0.2);
        }

        .stat-card.expired-members .stat-value {
            color: var(--danger-color);
            text-shadow: 0 2px 3px rgba(247, 37, 133, 0.2);
        }

        .stat-change {
            font-size: 0.875rem;
            color: #6c757d;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #dee2e6;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            position: relative;
        }

        .tab:hover {
            color: var(--primary-color);
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab::after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .tab:hover::after {
            transform: scaleX(1);
        }

        .tab.active::after {
            transform: scaleX(1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success-color);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            z-index: 1000;
            display: flex;
            align-items: center;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast i {
            margin-left: 0.5rem;
        }

        .toast.error {
            background-color: var(--danger-color);
            box-shadow: 0 5px 15px rgba(247, 37, 133, 0.3);
        }

        .toast.warning {
            background-color: var(--warning-color);
            box-shadow: 0 5px 15px rgba(248, 150, 30, 0.3);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Pulse Animation */
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.7; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .club-name {
                font-size: 1.4rem;
            }
            
            .logo {
                width: 100px;
                height: 100px;
            }
            
            .btn {
                padding: 0.6rem 1rem;
                font-size: 0.875rem;
            }
            
            .form-section {
                padding: 1.5rem;
            }
            
            .members-table th,
            .members-table td {
                padding: 0.75rem;
                font-size: 0.875rem;
            }
            
            .stats-section {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 1rem;
            }
            
            .container {
                padding: 0.5rem;
            }
            
            .tabs {
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 5px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(67, 97, 238, 0.3); }
            50% { box-shadow: 0 0 20px rgba(67, 97, 238, 0.5); }
            100% { box-shadow: 0 0 5px rgba(67, 97, 238, 0.3); }
        }

        .glowing {
            animation: glow 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo-container">
                <div class="logo glowing">
                    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjneSenlewCewrAJE5xFQM0S3t46_lNzhbbi6TMsAwo4wQ8K0VSZeVAWobEmJkeFjj1zLf__qaoXhO2Vnc4-F6nhcSpnvP08FxfY0NjRlSKb12RG3gZfCzQUYfQEhyphenhyphen6JkBn36ck3QVBKv5yV3LCNo79164KauMIL8UOUhBjVfRAi1-202KpjlYNBOlmvOLC/s1080/IMG-20250810-WA0001.jpg" alt="شعار النادي" id="clubLogo">
                </div>
                <div class="club-name">FITTO GYM</div>
            </div>
            <h1>نظام إدارة المشتركين</h1>
            <p>إدارة كاملة لأعضاء النادي وتتبع الاشتراكات</p>
        </header>

        <!-- إحصائيات المشتركين -->
        <div class="stats-section">
            <div class="stat-card active-members">
                <h3 class="stat-title">المشتركين النشطين</h3>
                <div class="stat-value" id="activeMembersCount">0</div>
                <div class="stat-change">اشتراكات سارية المفعول</div>
            </div>
            <div class="stat-card expired-members">
                <h3 class="stat-title">المشتركين المنتهية اشتراكاتهم</h3>
                <div class="stat-value" id="expiredMembersCount">0</div>
                <div class="stat-change">بحاجة إلى تجديد</div>
            </div>
        </div>

        <button id="toggleFormBtn" class="btn">
            <i class="fas fa-user-plus"></i> إضافة عضو جديد
        </button>

        <!-- نموذج إضافة عضو جديد -->
        <section id="addMemberSection" class="form-section">
            <h2><i class="fas fa-user-edit"></i> نموذج إدارة العضو</h2>
            <form id="memberForm" class="form-grid">
                <input type="hidden" id="memberId">
                
                <div class="form-group">
                    <label for="memberName"><i class="fas fa-user"></i> اسم العضو</label>
                    <input type="text" id="memberName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="phoneNumber"><i class="fas fa-phone"></i> رقم الهاتف</label>
                    <input type="tel" id="phoneNumber" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="subscriptionMonths"><i class="fas fa-calendar-alt"></i> مدة الاشتراك (شهور)</label>
                    <select id="subscriptionMonths" class="form-control" required>
                        <option value="1">1 شهر</option>
                        <option value="2">2 شهر</option>
                        <option value="3">3 شهور</option>
                        <option value="4">4 شهور</option>
                        <option value="5">5 شهور</option>
                        <option value="6">6 شهور</option>
                        <option value="7">7 شهور</option>
                        <option value="8">8 شهور</option>
                        <option value="9">9 شهور</option>
                        <option value="10">10 شهور</option>
                        <option value="11">11 شهر</option>
                        <option value="12">12 شهر (سنة)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="startDate"><i class="fas fa-calendar-alt"></i> تاريخ بداية الاشتراك</label>
                    <input type="date" id="startDate" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="endDate"><i class="fas fa-calendar-times"></i> تاريخ نهاية الاشتراك</label>
                    <input type="date" id="endDate" class="form-control" required readonly>
                </div>
                
                <div class="form-group">
                    <label for="subscriptionFee"><i class="fas fa-money-bill-wave"></i> رسوم الاشتراك الكاملة</label>
                    <input type="number" id="subscriptionFee" class="form-control" required min="0" step="any"> <!-- تم تعديله لقبول أي رقم -->
                </div>
                
                <div class="form-group">
                    <label for="amountPaid"><i class="fas fa-hand-holding-usd"></i> المبلغ المدفوع</label>
                    <input type="number" id="amountPaid" class="form-control" required min="0" step="any"> <!-- تم تعديله لقبول أي رقم -->
                </div>
                
                <div class="form-group">
                    <label for="paymentStatus"><i class="fas fa-check-circle"></i> حالة الدفع</label>
                    <select id="paymentStatus" class="form-control" required>
                        <option value="paid">مسدد</option>
                        <option value="unpaid">غير مسدد</option>
                    </select>
                </div>
                
                <div class="form-group" style="grid-column: 1 / -1;">
                    <button type="submit" class="btn" id="submitBtn" style="width: 100%;">
                        <i class="fas fa-save"></i> حفظ العضو
                    </button>
                </div>
                
                <div class="form-group" style="grid-column: 1 / -1; display: none;" id="cancelEditDiv">
                    <button type="button" class="btn btn-warning" id="cancelEditBtn" style="width: 100%;">
                        <i class="fas fa-times"></i> إلغاء التعديل
                    </button>
                </div>
            </form>
        </section>
        
        <!-- قوائم المشتركين -->
        <section class="table-section fade-in">
            <div class="tabs">
                <div class="tab active" data-tab="all">جميع المشتركين</div>
                <div class="tab" data-tab="active">المشتركين النشطين</div>
                <div class="tab" data-tab="expired">الاشتراكات المنتهية</div>
            </div>
            
            <!-- صندوق البحث -->
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" class="search-box" placeholder="ابحث عن مشترك بالاسم أو رقم الهاتف...">
            </div>
            
            <div class="tab-content active" id="all-members">
                <h2><i class="fas fa-users"></i> قائمة جميع المشتركين</h2>
                <div class="table-responsive">
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>اسم العضو</th>
                                <th>رقم الهاتف</th>
                                <th>بداية الاشتراك</th>
                                <th>نهاية الاشتراك</th>
                                <th>حالة الاشتراك</th>
                                <th>حالة الدفع</th>
                                <th>المبلغ المدفوع</th>
                                <th>المبلغ المتبقي</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="membersList">
                            <!-- سيتم ملء هذا القسم بالبيانات من Firebase -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-content" id="active-members">
                <h2><i class="fas fa-user-check"></i> المشتركين النشطين</h2>
                <div class="table-responsive">
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>اسم العضو</th>
                                <th>رقم الهاتف</th>
                                <th>بداية الاشتراك</th>
                                <th>نهاية الاشتراك</th>
                                <th>حالة الدفع</th>
                                <th>المبلغ المدفوع</th>
                                <th>المبلغ المتبقي</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="activeMembersList">
                            <!-- سيتم ملء هذا القسم بالبيانات من Firebase -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-content" id="expired-members">
                <h2><i class="fas fa-user-clock"></i> الاشتراكات المنتهية</h2>
                <div class="table-responsive">
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>اسم العضو</th>
                                <th>رقم الهاتف</th>
                                <th>بداية الاشتراك</th>
                                <th>نهاية الاشتراك</th>
                                <th>حالة الدفع</th>
                                <th>المبلغ المدفوع</th>
                                <th>المبلغ المتبقي</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="expiredMembersList">
                            <!-- سيتم ملء هذا القسم بالبيانات من Firebase -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">تمت العملية بنجاح</span>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBMJe0CVmxCrFthFmJEs5W_p1x3AFpFmHQ",
            authDomain: "moaz-a8190.firebaseapp.com",
            databaseURL: "https://moaz-a8190-default-rtdb.firebaseio.com",
            projectId: "moaz-a8190",
            storageBucket: "moaz-a8190.appspot.com",
            messagingSenderId: "839870478124",
            appId: "1:839870478124:web:904d5776d12a406e179e89",
            measurementId: "G-9S19GW5E26"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
        
        // Initialize Realtime Database
        const database = firebase.database();
        const membersRef = database.ref('members');

        // DOM elements
        const toggleFormBtn = document.getElementById('toggleFormBtn');
        const addMemberSection = document.getElementById('addMemberSection');
        const memberForm = document.getElementById('memberForm');
        const membersList = document.getElementById('membersList');
        const activeMembersList = document.getElementById('activeMembersList');
        const expiredMembersList = document.getElementById('expiredMembersList');
        const activeMembersCount = document.getElementById('activeMembersCount');
        const expiredMembersCount = document.getElementById('expiredMembersCount');
        const subscriptionMonths = document.getElementById('subscriptionMonths');
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        const subscriptionFeeInput = document.getElementById('subscriptionFee');
        const amountPaidInput = document.getElementById('amountPaid');
        const submitBtn = document.getElementById('submitBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const cancelEditDiv = document.getElementById('cancelEditDiv');
        const memberIdInput = document.getElementById('memberId');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const clubLogo = document.getElementById('clubLogo');
        const searchInput = document.getElementById('searchInput');

        // متغير لتحديد ما إذا كنا في وضع التعديل
        let isEditMode = false;
        let currentMemberId = null;
        let allMembers = [];

        // عرض/إخفاء نموذج الإضافة
        toggleFormBtn.addEventListener('click', function() {
            addMemberSection.classList.toggle('active');
            
            // تغيير نص الزر حسب حالة النموذج
            if (addMemberSection.classList.contains('active')) {
                toggleFormBtn.innerHTML = '<i class="fas fa-times"></i> إغلاق النموذج';
            } else {
                toggleFormBtn.innerHTML = '<i class="fas fa-user-plus"></i> إضافة عضو جديد';
                cancelEdit();
            }
        });

        // حساب تاريخ نهاية الاشتراك عند تغيير تاريخ البدء أو عدد الأشهر
        function calculateEndDate() {
            const months = parseInt(subscriptionMonths.value);
            const startDate = new Date(startDateInput.value);
            
            if (!isNaN(startDate.getTime())) {
                const endDate = new Date(startDate);
                endDate.setMonth(startDate.getMonth() + months);
                endDateInput.value = endDate.toISOString().split('T')[0];
            }
        }

        // استماع لتغيير تاريخ البدء أو عدد الأشهر
        startDateInput.addEventListener('change', calculateEndDate);
        subscriptionMonths.addEventListener('change', calculateEndDate);

        // التحقق من أن المبلغ المدفوع لا يتجاوز رسوم الاشتراك
        amountPaidInput.addEventListener('input', function() {
            const subscriptionFee = parseFloat(subscriptionFeeInput.value) || 0;
            const amountPaid = parseFloat(this.value) || 0;
            
            if (amountPaid > subscriptionFee) {
                this.value = subscriptionFee;
                showToast('المبلغ المدفوع لا يمكن أن يتجاوز رسوم الاشتراك', 'warning');
            }
        });

        // عرض رسالة Toast
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = 'toast show';
            
            // تغيير لون الـ Toast حسب النوع
            if (type === 'error') {
                toast.classList.add('error');
            } else if (type === 'warning') {
                toast.classList.add('warning');
            } else {
                toast.classList.remove('error', 'warning');
            }
            
            // إخفاء الـ Toast بعد 3 ثواني
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // إضافة/تعديل عضو
        memberForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // التحقق من صحة البيانات
            const name = document.getElementById('memberName').value.trim();
            const phone = document.getElementById('phoneNumber').value.trim();
            const startDate = startDateInput.value;
            const endDate = endDateInput.value;
            const subscriptionFee = parseFloat(subscriptionFeeInput.value);
            const amountPaid = parseFloat(document.getElementById('amountPaid').value) || 0;
            const paymentStatus = document.getElementById('paymentStatus').value;
            
            if (!name || !phone || !startDate || !endDate || isNaN(subscriptionFee)) {
                showToast('الرجاء تعبئة جميع الحقول المطلوبة', 'error');
                return;
            }
            
            if (amountPaid > subscriptionFee) {
                showToast('المبلغ المدفوع لا يمكن أن يتجاوز رسوم الاشتراك', 'error');
                return;
            }
            
            const memberData = {
                name: name,
                phone: phone,
                startDate: startDate,
                endDate: endDate,
                subscriptionFee: subscriptionFee,
                amountPaid: amountPaid,
                paymentStatus: paymentStatus,
                updatedAt: firebase.database.ServerValue.TIMESTAMP
            };
            
            // عرض مؤشر التحميل
            submitBtn.innerHTML = '<div class="spinner"></div> جاري الحفظ...';
            submitBtn.disabled = true;
            
            if (isEditMode) {
                // تحديث العضو الموجود في Firebase
                membersRef.child(currentMemberId).update(memberData)
                    .then(() => {
                        showToast('تم تعديل بيانات العضو بنجاح');
                        resetForm();
                    })
                    .catch(error => {
                        showToast('حدث خطأ أثناء تعديل العضو: ' + error.message, 'error');
                    })
                    .finally(() => {
                        submitBtn.innerHTML = '<i class="fas fa-save"></i> حفظ التعديلات';
                        submitBtn.disabled = false;
                    });
            } else {
                // إضافة عضو جديد إلى Firebase
                membersRef.push({
                    ...memberData,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                })
                .then(() => {
                    showToast('تم إضافة العضو الجديد بنجاح');
                    resetForm();
                })
                .catch(error => {
                    showToast('حدث خطأ أثناء إضافة العضو: ' + error.message, 'error');
                })
                .finally(() => {
                    submitBtn.innerHTML = '<i class="fas fa-save"></i> حفظ العضو';
                    submitBtn.disabled = false;
                });
            }
        });

        // إلغاء التعديل
        cancelEditBtn.addEventListener('click', cancelEdit);

        function cancelEdit() {
            isEditMode = false;
            currentMemberId = null;
            submitBtn.innerHTML = '<i class="fas fa-save"></i> حفظ العضو';
            cancelEditDiv.style.display = 'none';
            resetForm();
            showToast('تم إلغاء التعديل');
        }

        // إعادة تعيين النموذج
        function resetForm() {
            memberForm.reset();
            memberIdInput.value = '';
            
            // تعيين تاريخ اليوم كقيمة افتراضية لتاريخ البدء
            const today = new Date().toISOString().split('T')[0];
            startDateInput.value = today;
            
            // تعيين حالة الدفع إلى "مسدد" كقيمة افتراضية
            document.getElementById('paymentStatus').value = 'paid';
            
            // حساب تاريخ نهاية الاشتراك
            calculateEndDate();
        }

        // تعديل عضو
        function editMember(memberId) {
            membersRef.child(memberId).once('value')
                .then(snapshot => {
                    const member = snapshot.val();
                    if (!member) return;
                    
                    // تعبئة النموذج ببيانات العضو
                    memberIdInput.value = memberId;
                    document.getElementById('memberName').value = member.name;
                    document.getElementById('phoneNumber').value = member.phone;
                    
                    // حساب عدد أشهر الاشتراك
                    const startDate = new Date(member.startDate);
                    const endDate = new Date(member.endDate);
                    const monthsDiff = (endDate.getFullYear() - startDate.getFullYear()) * 12 + 
                                      (endDate.getMonth() - startDate.getMonth());
                    
                    subscriptionMonths.value = monthsDiff;
                    startDateInput.value = member.startDate;
                    endDateInput.value = member.endDate;
                    subscriptionFeeInput.value = member.subscriptionFee;
                    document.getElementById('amountPaid').value = member.amountPaid;
                    document.getElementById('paymentStatus').value = member.paymentStatus;
                    
                    // تغيير إلى وضع التعديل
                    isEditMode = true;
                    currentMemberId = memberId;
                    submitBtn.innerHTML = '<i class="fas fa-save"></i> حفظ التعديلات';
                    cancelEditDiv.style.display = 'block';
                    
                    // فتح النموذج إذا كان مغلقاً
                    if (!addMemberSection.classList.contains('active')) {
                        addMemberSection.classList.add('active');
                        toggleFormBtn.innerHTML = '<i class="fas fa-times"></i> إغلاق النموذج';
                    }
                    
                    // التمرير إلى النموذج
                    addMemberSection.scrollIntoView({ behavior: 'smooth' });
                })
                .catch(error => {
                    showToast('حدث خطأ أثناء تحميل بيانات العضو: ' + error.message, 'error');
                });
        }

        // حذف عضو
        function deleteMember(memberId) {
            if (confirm('هل أنت متأكد من حذف هذا العضو؟ لا يمكن التراجع عن هذه العملية.')) {
                membersRef.child(memberId).remove()
                    .then(() => {
                        showToast('تم حذف العضو بنجاح');
                        
                        // إذا كنا في وضع التعديل للعضو المحذوف، نخرج من وضع التعديل
                        if (isEditMode && currentMemberId === memberId) {
                            cancelEdit();
                        }
                    })
                    .catch(error => {
                        showToast('حدث خطأ أثناء حذف العضو: ' + error.message, 'error');
                    });
            }
        }

        // تجديد الاشتراك
        function renewSubscription(memberId) {
            membersRef.child(memberId).once('value')
                .then(snapshot => {
                    const member = snapshot.val();
                    if (!member) return;
                    
                    const endDate = new Date(member.endDate);
                    const today = new Date();
                    
                    // إذا كان الاشتراك منتهيًا، نبدأ التجديد من اليوم
                    // وإلا نضيف شهرًا إلى تاريخ الانتهاء الحالي
                    const newEndDate = endDate < today 
                        ? new Date(today.setMonth(today.getMonth() + 1))
                        : new Date(endDate.setMonth(endDate.getMonth() + 1));
                    
                    // إعادة حساب المبلغ المتبقي
                    const remainingAmount = member.subscriptionFee - member.amountPaid;
                    
                    const updateData = {
                        endDate: newEndDate.toISOString().split('T')[0],
                        updatedAt: firebase.database.ServerValue.TIMESTAMP
                    };
                    
                    if (remainingAmount > 0) {
                        if (confirm(`هناك مبلغ ${remainingAmount} E.G متبقٍ. هل تريد إضافته للفاتورة الجديدة؟`)) {
                            updateData.subscriptionFee = member.subscriptionFee + remainingAmount;
                        }
                    }
                    
                    return membersRef.child(memberId).update(updateData);
                })
                .then(() => {
                    showToast('تم تجديد الاشتراك بنجاح لمدة شهر إضافي');
                })
                .catch(error => {
                    showToast('حدث خطأ أثناء تجديد الاشتراك: ' + error.message, 'error');
                });
        }

        // تبديل بين التبويبات
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // تحديث التبويب النشط
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // تحديث المحتوى المعروض
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`${tabId}-members`).classList.add('active');
            });
        });

        // تنسيق التاريخ
        function formatDate(dateString) {
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return 'غير محدد';
            
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('ar-EG', options);
        }

        // البحث عن المشتركين
        function searchMembers(query) {
            const normalizedQuery = query.toLowerCase().trim();
            
            if (!normalizedQuery) {
                // إذا كان صندوق البحث فارغاً، عرض جميع المشتركين
                renderMembers(allMembers);
                return;
            }
            
            const filteredMembers = allMembers.filter(member => {
                return (
                    member.name.toLowerCase().includes(normalizedQuery) ||
                    member.phone.includes(normalizedQuery)
                );
            });
            
            renderMembers(filteredMembers);
        }

        // عرض المشتركين في الجداول
        function renderMembers(members) {
            membersList.innerHTML = '';
            activeMembersList.innerHTML = '';
            expiredMembersList.innerHTML = '';
            
            let activeCount = 0;
            let expiredCount = 0;
            const today = new Date();
            
            members.forEach(member => {
                const remainingAmount = member.subscriptionFee - member.amountPaid;
                const isPaid = member.paymentStatus === 'paid';
                const statusClass = isPaid ? 'status-paid' : 'status-unpaid';
                const statusIcon = isPaid ? 'fa-check-circle' : 'fa-times-circle';
                const amountClass = remainingAmount > 0 ? 'amount-due' : 'amount-remaining';
                const amountText = remainingAmount > 0 ? 
                    `${Math.abs(remainingAmount)} E.G (متبقي)` : 
                    `${Math.abs(remainingAmount)} E.G (زيادة)`;
                
                const endDate = new Date(member.endDate);
                const isActive = endDate >= today;
                const subscriptionStatusClass = isActive ? 'status-active' : 'status-expired';
                const subscriptionStatusIcon = isActive ? 'fa-check-circle' : 'fa-exclamation-circle';
                const subscriptionStatusText = isActive ? 'نشط' : 'منتهي';
                
                if (isActive) activeCount++;
                else expiredCount++;
                
                // قائمة جميع المشتركين
                const row = document.createElement('tr');
                row.className = isActive ? 'active-member' : 'expired-member';
                row.innerHTML = `
                    <td>${member.name}</td>
                    <td>${member.phone}</td>
                    <td>${formatDate(member.startDate)}</td>
                    <td>${formatDate(member.endDate)}</td>
                    <td>
                        <span class="status ${subscriptionStatusClass}">
                            ${subscriptionStatusText}
                            <i class="fas ${subscriptionStatusIcon} status-icon"></i>
                        </span>
                    </td>
                    <td>
                        <span class="status ${statusClass}">
                            ${isPaid ? 'مسدد' : 'غير مسدد'}
                            <i class="fas ${statusIcon} status-icon"></i>
                        </span>
                    </td>
                    <td class="amount">${member.amountPaid} E.G</td>
                    <td class="amount ${amountClass}">${amountText}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-sm" onclick="editMember('${member.id}')" title="تعديل">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteMember('${member.id}')" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                            ${!isActive ? `<button class="btn btn-sm btn-success" onclick="renewSubscription('${member.id}')" title="تجديد">
                                <i class="fas fa-sync-alt"></i>
                            </button>` : ''}
                        </div>
                    </td>
                `;
                
                // إضافة حلقة دائرية حول المشترك
                const circle = document.createElement('div');
                circle.className = 'member-circle';
                row.appendChild(circle);
                
                // إضافة فاصل مضيء
                row.classList.add('member-separator');
                
                membersList.appendChild(row);
                
                // قائمة المشتركين النشطين
                if (isActive) {
                    const activeRow = document.createElement('tr');
                    activeRow.className = 'active-member';
                    activeRow.innerHTML = `
                        <td>${member.name}</td>
                        <td>${member.phone}</td>
                        <td>${formatDate(member.startDate)}</td>
                        <td>${formatDate(member.endDate)}</td>
                        <td>
                            <span class="status ${statusClass}">
                                ${isPaid ? 'مسدد' : 'غير مسدد'}
                                <i class="fas ${statusIcon} status-icon"></i>
                            </span>
                        </td>
                        <td class="amount">${member.amountPaid} E.G</td>
                        <td class="amount ${amountClass}">${amountText}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm" onclick="editMember('${member.id}')" title="تعديل">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="deleteMember('${member.id}')" title="حذف">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // إضافة حلقة دائرية حول المشترك
                    const activeCircle = document.createElement('div');
                    activeCircle.className = 'member-circle';
                    activeRow.appendChild(activeCircle);
                    
                    // إضافة فاصل مضيء
                    activeRow.classList.add('member-separator');
                    
                    activeMembersList.appendChild(activeRow);
                }
                
                // قائمة المشتركين المنتهية اشتراكاتهم
                else {
                    const expiredRow = document.createElement('tr');
                    expiredRow.className = 'expired-member';
                    expiredRow.innerHTML = `
                        <td>${member.name}</td>
                        <td>${member.phone}</td>
                        <td>${formatDate(member.startDate)}</td>
                        <td>${formatDate(member.endDate)}</td>
                        <td>
                            <span class="status ${statusClass}">
                                ${isPaid ? 'مسدد' : 'غير مسدد'}
                                <i class="fas ${statusIcon} status-icon"></i>
                            </span>
                        </td>
                        <td class="amount">${member.amountPaid} E.G</td>
                        <td class="amount ${amountClass}">${amountText}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-sm btn-success" onclick="renewSubscription('${member.id}')" title="تجديد">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                                <button class="btn btn-sm" onclick="editMember('${member.id}')" title="تعديل">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="deleteMember('${member.id}')" title="حذف">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    
                    // إضافة حلقة دائرية حول المشترك
                    const expiredCircle = document.createElement('div');
                    expiredCircle.className = 'member-circle';
                    expiredRow.appendChild(expiredCircle);
                    
                    // إضافة فاصل مضيء
                    expiredRow.classList.add('member-separator');
                    
                    expiredMembersList.appendChild(expiredRow);
                }
            });
            
            // تحديث الإحصائيات
            activeMembersCount.textContent = activeCount;
            expiredMembersCount.textContent = expiredCount;
        }

        // تحديث قوائم المشتركين عند تغيير البيانات في Firebase
        membersRef.on('value', function(snapshot) {
            allMembers = [];
            
            snapshot.forEach(childSnapshot => {
                const member = childSnapshot.val();
                member.id = childSnapshot.key;
                allMembers.push(member);
            });
            
            renderMembers(allMembers);
        });

        // البحث عند كتابة نص في صندوق البحث
        searchInput.addEventListener('input', function() {
            searchMembers(this.value);
        });

        // التحميل الأولي للصفحة
        document.addEventListener('DOMContentLoaded', function() {
            resetForm();
            
            // تعيين تاريخ اليوم كقيمة افتراضية
            const today = new Date().toISOString().split('T')[0];
            startDateInput.value = today;
            calculateEndDate();
            
            // جعل الدوال متاحة للاستدعاء من الأحداث المضمنة في HTML
            window.editMember = editMember;
            window.deleteMember = deleteMember;
            window.renewSubscription = renewSubscription;
        });
    </script>
</body>
</html>
